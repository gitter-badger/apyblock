#!/bin/bash
# A Shell Blocker
# The script for blocking ADs on the web.
# Copyright 2015, Federico Dami√°n Schonborn <federicodamians@gmail.com>
# License: GPLv2

# Configurations:

# Set the webpage for downloading the /etc/hosts file:
file_source="http://winhelp2002.mvps.org/hosts.txt"

# Color prompts:

bold="\e[1;34m>> \e[0m\e[1m"
error="\e[1;31m\u274C \e[0m\e[1m"
done="\e[32;1m\u2713 \e[0m\e[1m"
endc="\e[0m"
line="\n"

# Functions:

# Print some messages:
print_message() {
  echo -e ""$bold""$1""$endc""
}

# Print some errors:
print_error() {
  echo -e ""$line""$error""$1""$endc""$line""
  exit 1
}

# Print some success:
print_success() {
  echo -e ""$line""$done""$1""$endc""$line""
}

# Check if you're root:
check_root() {
  if [ $(whoami) != "root" ]; then
    print_error "Please run ashblock as ROOT!"
  fi
}

# Check if command runned successfully:
check_success() {
  if [ "$?" == "0" ]; then
    print_success "DONE! :D"
  else
    print_error "FAILED! :("
  fi
}

case $1 in
  about)
    print_message "A Shell Blocker"
    print_message "The script for blocking ADs on the web."
    print_message "Version: 1.0.1 \"Antaros\""
    print_message "License: GPLv2"
    ;;
  help)
    print_message "Usage: ashblock [COMMAND]"$line""
    print_message "Available commands:"$line""
    print_message "update   Updates the /etc/hosts file"
    print_message "about    About ashblock"
    print_message "help     This."
    ;;
  update)
    check_root
    print_message ""$line"Downloading hosts file..."$line""
    wget ${file_source} -O /etc/hosts
    check_success
esac
